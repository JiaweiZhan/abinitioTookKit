# pyldos

pyldos is a tool for computing [local density of states](https://en.wikipedia.org/wiki/Density_of_states) by analyzing wavefunctions generated by [Quantum Espresso](https://www.quantum-espresso.org)

## Features
* Directly read the binary output generated by Quantum Espresso 
* Support *multi-kpoints*, *spin-polarized calculation* (LSDA)
* Paralleled by using *multithreads* 

## Library Files
* `class_ldos.py` has the main class for computing local band edge (local CBM and VBM)
* `qe_io.py` is a general I/O class to parse Quantum Espresso's binary output
* `utils.py` includes some useful functions to output/analyze local band edge

## How to use

1. ssh to interactive session to utilize computing node (1 node is enough)
2. Create a python file to call functions from **Library Files**
```python
    from class_ldos import LDOS
    import qe_io
    import utils

    # delta is the parameter to control the location of LCBM/LVBM
    # numThread: how many threads are used to store wfcs/compute ldos
    # saveFolder: the location of the *.save folder 
    # backup: save wfc to decrease the requirement of memory (1:save, 0: not save) 
    localDensityOfState = class_ldos.LDOS(delta, numThread, saveFolder, backup)

    localDensityOfState.computeLDOS()

    lcbm, lvbm = localDensityOfState.localBandEdge()

    utils.writeLocalBandEdge(lcbm=lcbm, lvbm=lvbm, fileName='ldos.txt')
```
see [`example.py`](./example.py) for reference

3. Run:
```
python3 example.py [-h] [-s SAVE_FOLDER] [-d DELTA] [-t THREAD] [-b BACKUP]
```
4. Configuration:
```
optional arguments:
  -h, --help            show this help message and exit
  -s SAVE_FOLDER, --save_folder SAVE_FOLDER
                        *.save folder generated by QE. Default: ./scf.save
  -d DELTA, --delta DELTA
                        delta that control local VB/CB. Default: 0.001
  -t THREAD, --thread THREAD
                        num of thread. Default: [max #cpu] - 1
  -b BACKUP, --backup BACKUP
                        store wfc on disk 1 or not 0 (store in memory). Default: 1 for saving memory
```

## Requirements
version of Quantum Espresso >= 5.4

## TODO
Build the I/O API for other quantum chemistry softwares ([Qbox](http://qboxcode.org))
